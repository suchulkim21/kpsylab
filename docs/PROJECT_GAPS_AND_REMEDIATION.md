# KPSY LAB 프로젝트 부족 부분 및 보완 방안

**문서 성격**: 프로젝트 전반의 격차 분석 및 보완 방향 연구 결과.  
**참조**: SYSTEM_CHECK_REPORT, NEXT_STEPS, REMAINING_5_PERCENT_DETAIL, MNPS_TEST_OVERVIEW, PROJECT_PHILOSOPHY, [RESEARCH_PURPOSE_AND_SCOPE](./RESEARCH_PURPOSE_AND_SCOPE.md), ACCESSIBILITY 등 기존 문서를 종합함.

---

## 1. 연구 목적 및 범위

본 문서는 KPSY LAB(kpsylab.com) 및 관련 앱(portal, MNPS, second-genesis)에서 **부족한 부분**을 식별하고, **어떻게 보완할지**를 한글 기준 문서로 정리한 것이다.  
코드·구조·콘텐츠·문서·운영·철학 정합성까지를 범위로 하되, “무엇이 부족한가”와 “그것을 어떻게 채울 것인가”에 초점을 둔다.

---

## 2. 철학·정체성 부문

### 2.1 현황

- **PROJECT_PHILOSOPHY.md**와 **.cursorrules**에 “맥락적 존재”, “비이분법”, “연결성”, “맥락 우선주의” 등이 명시되어 있음.
- UI·콘텐츠는 “정답이 아닌 도면”, “검증된 심리학·과학적 방법”을 내세우나, **맥락적 존재를 UI/플로우에서 명시적으로 표현하는 설계 원칙**은 문서화되어 있지 않음.
- **마인드 아키텍터(성장 로드맵)**는 현재 `MIND_ARCHITECT_ENABLED = false`로 비노출. **MNPS** 역시 `MNPS_ENABLED = false`로 비노출 상태라, 실제 서비스 진입점이 제한적임.

### 2.2 부족한 점

| 항목 | 내용 |
|------|------|
| 철학–UI 매핑 부재 | “맥락적 존재”가 버튼·카드·결과 페이지·내비게이션에서 **어떤 패턴**으로 구현되는지에 대한 가이드가 없음. |
| 서비스 정체성 일관성 | 블로그·MNPS·성장 로드맵 간 톤과 “도면/이정표” 메시지가 완전히 통일되어 있지 않을 수 있음. |
| 기능 플래그와 런칭 전략 | MNPS·마인드 아키텍터를 언제·어떤 조건으로 켤지에 대한 운영 원칙이 문서에 없음. |

### 2.3 보완 방안

1. **철학–UI 매핑 문서 작성**  
   - `docs/PHILOSOPHY_UI_MAPPING.md`(가칭)에서 “맥락적 존재”를 다음 단위로 분해해 기술:  
     - **가변성**: 결과·라벨을 “고정된 정답”이 아닌 “이 맥락에서의 한 해석”으로 보이게 하는 문구·시각(예: “이 결과는 당신의 현재 맥락에서의 한 도면입니다”).  
     - **비이분법**: 선/악, 정상/비정상을 이분하지 않고, 구간·연속체·회색지대를 보여주는 차트·문장 설계.  
     - **연결성**: 단일 점수보다 “특성 간 관계”, “이전 결과와의 연결”, “블록화·연결” 메타포를 UI에 반영.  
   - 새 모듈 설계 시 “이 기능이 맥락적 존재를 UI적으로 어떻게 표현하는가?”를 체크리스트로 사용.

2. **콘텐츠·톤 가이드 정리**  
   - 블로그·가이드·결과 문구에 공통 적용할 “묵직한 통찰·배경 설명·검증된 심리학 연결” 원칙을 `docs/CONTENT_TONE_GUIDE.md`에 정리.  
   - STORYTELLING_STRATEGY와 PROJECT_PHILOSOPHY를 한 축으로 참조하도록 연결.

3. **기능 플래그·런칭 전략 문서화**  
   - `featureFlags.ts`의 의도, MNPS/마인드 아키텍터/블로그를 켜는 조건(베타/정식/점진 노출)을 `docs/FEATURE_FLAGS_AND_LAUNCH.md`에 기록.  
   - 배포·환경별로 어떤 플래그 조합을 쓰는지 명시.

---

## 3. 기술·품질 부문

### 3.1 빌드·린트

- **빌드**: TypeScript 오류는 이전 점검에서 수정되어 `npm run build` 통과 상태로 보고됨.  
- **린트**: `SYSTEM_CHECK_REPORT` 기준 에러·경고 다수. 이후 `.cursorrules` 적용·스크립트 override 등으로 일부 완화했으나, **에러 0·경고 감소**는 지속 과제.

### 3.2 부족한 점

| 항목 | 내용 |
|------|------|
| 린트 일관성 | 일부 파일만 수정·override에 의존. 신규 코드는 규칙을 지키되, 레거시는 단계적 정리 필요. |
| Next.js 16+ 마이그레이션 | middleware deprecated → proxy 전환 권장. 아직 미적용. |
| 타입·스키마 문서화 | 복잡한 adapter·report·psychologicalMap 등 타입이 코드 밖에 정리된 문서가 부족함. |

### 3.3 보완 방안

1. **린트 단계적 정리**  
   - `npm run lint`에서 **error**가 0이 되도록 우선 처리.  
   - 경고는 “새 코드만 경고 0” 정책을 두고, 파일 단위로 수정.  
   - `scripts/`, `lib/db/*.js` 등 Node 스크립트는 `.cursorrules`와 동일하게 `no-require-imports` off 유지하되, 필요 시 해당 디렉터리만 override로 명시.

2. **Next.js proxy 마이그레이션**  
   - 공식 가이드에 따라 `middleware` → `proxy` 전환 계획을 세우고, 한 번에 하지 않아도 “단계별 마이그레이션” 문서를 두어 추적.

3. **핵심 타입·스키마 문서**  
   - `lib/adapters/report-adapter`, `lib/services/psychologicalMap`, MNPS 결과 스키마 등 **핵심 타입·인터페이스**를 `docs/TYPE_AND_SCHEMA_REFERENCE.md`에 요약.  
   - “왜 이 구조인가” 맥락을 PROJECT_PHILOSOPHY의 “맥락 우선주의”에 맞춰 간단히 기술.

---

## 4. 테스트·자동화 부문

### 4.1 현황 (REMAINING_5_PERCENT_DETAIL 기준)

- 단위 테스트: 핵심 함수 일부 완료.  
- 통합 테스트: 미완료.  
- E2E: Playwright 등 설정·일부 스펙 존재(accessibility, blog, error-handling, navigation).  
- CI/CD: 구조만 있고, 자동 테스트·자동 배포는 미완성.

### 4.2 부족한 점

| 항목 | 내용 |
|------|------|
| API·인증 통합 테스트 | `/api/auth/*`, `/api/blog/*`, `/api/admin/*`, MNPS complete API 등 시나리오 부재. |
| E2E 커버리지 | 회원가입→로그인, MNPS 전체 플로우, 성장 로드맵 플로우, 관리자 접근 등 핵심 여정 미비. |
| CI 파이프라인 | PR 시 자동 린트·테스트·빌드가 없음. |

### 4.3 보완 방안

1. **우선순위 테스트 시나리오 정의**  
   - “MNPS: 응답 제출 → complete → 결과 페이지까지” 한 사이클 E2E.  
   - “성장 로드맵: M1 완료 → 결과 확인” 한 사이클 E2E.  
   - API: `POST /api/mnps/complete`, `GET /api/mnps/results` 등 최소 1~2개 시나리오 통합 테스트.

2. **CI 최소 사양**  
   - GitHub Actions(또는 사용 중인 CI)에서: `npm ci` → `npm run lint` → `npm run test` → `npm run build`.  
   - main/develop 브랜치 푸시 또는 PR 시 실행. 실패 시 머지 차단 정책은 팀 규칙에 따름.

3. **문서화**  
   - “어떤 테스트를 어디서 어떻게 돌리는지”를 `docs/TESTING_GUIDE.md`에 정리.  
   - E2E 실행 방법, 테스트 데이터·환경 변수 요구 사항 명시.

---

## 5. 콘텐츠·UX 부문

### 5.1 현황

- MNPS: 현재 42문항 고정·Good/Bad 이중 리포트·아키타입·시너지·딥다이브·D요인·Final Ruin 등이 있으나, **서비스의 중심은 문항이 아니라 테스트 진행 후 사용자에게 보여줄 분석 리포트**이다. 문답은 콘텐츠의 **시작**이지 최종 콘텐츠가 아님. 2~3회 재검사하는 사용자에게 매번 같은 문항을 주면 재검사의 의미가 없으므로 **충분한 문항을 확보한 문제 은행(Item Bank)** 구축이 필요하다.  
- 블로그: Phase 1 주제·생성 스크립트·일정 존재. 품질 검증(최소 3,000자, 톤 등)은 수동·부분적.  
- CONTENT_BACKLOG: 감정 프레임워크(불안·외로움·무의미감 등) 활용 아이디어만 있고, 실제 블로그/MNPS 반영 계획은 구체화되지 않음.

### 5.2 부족한 점

| 항목 | 내용 |
|------|------|
| 블로그 톤 일관성 | “가벼운 블로그 톤”을 피하고 “묵직한 통찰”을 담으라는 PROJECT_PHILOSOPHY·Cursor 가이드와 실제 생성 포스트 간 정합성 검증 절차 부재. |
| MNPS 결과 페이지의 맥락 표현 | 결과가 “고정된 라벨”로 읽히지 않고 “맥락 속 한 도면”으로 읽히도록 하는 문구·시각 요소가 명시적으로 설계되어 있지 않음. |
| **문제 은행 부재** | 현재 42문항 고정. 재검사 시 동일 문항 반복으로 2~3회 검사하는 사용자에게 의미 없음. 충분한 문항을 모은 **문제 은행(Item Bank)** 이 없어 재검사 경험이 단조로움. |
| **분석 리포트가 서비스 중심** | 문항·선택지는 콘텐츠의 시작(입력)일 뿐. **테스트 진행 후 사용자에게 보여줄 분석 리포트** 작성·확장이 이 서비스의 핵심인데, 이를 전략 문서에서 "콘텐츠의 최종 형태"로 명시하지 않으면 문항 수 논의에만 치우치기 쉬움. |
| 감정·맥락 콘텐츠 연결 | CONTENT_BACKLOG의 감정 카테고리가 블로그·MNPS 해석·성장 로드맵에 어떻게 녹을지 로드맵 없음. |
| 빈 상태·에러 메시지 | 데이터 없음·오류 시 사용자에게 주는 문구가 “맥락적 존재”나 “도면” 메타포와 맞는지 검토 필요. |

### 5.3 보완 방안

1. **콘텐츠 품질 체크리스트**  
   - 블로그·가이드 발행 전: “검증된 심리학/뇌과학 맥락이 있는가”, “이분법적 판단을 강화하지 않는가”, “관계·질서가 드러나는가” 등을 체크리스트로 두고, 1인이라도 한 번 검토.

2. **MNPS 결과 페이지 문구·시각 개선**  
   - 결과 상단/하단에 “이 결과는 당신의 **현재 응답 맥락**에서 나온 한 장의 도면이며, 다른 시점·맥락에서는 다르게 읽힐 수 있습니다” 등 **가변성·맥락**을 드러내는 문구 추가.  
   - 차트·배지만으로는 “연속체·회색지대”가 잘 안 보일 수 있으므로, 필요 시 짧은 설명 문장으로 “구간” 의미를 보강.

3. **문제 은행(Item Bank) 구축**
   - 재검사 시 같은 42문항만 반복하면 의미가 없음. Dark Tetrad·D-Factor·검증·시나리오 각 카테고리별로 **동일 구인을 측정하는 대체 문항**을 충분히 개발하여 문제 은행을 만들고, 회차별 또는 랜덤 샘플링으로 42문항(또는 N문항)을 선출하도록 설계.
   - 문항은 콘텐츠의 **시작(입력)** 이고, **분석 리포트(테스트 후 사용자에게 보여줄 결과·해석)** 가 서비스의 중심임을 개발·기획 문서에 명시.

4. **감정 프레임워크 활용 계획**  
   - CONTENT_BACKLOG의 감정 카테고리를 “블로그 시리즈 주제”, “MNPS 해석 문구 톤 가이드”, “성장 로드맵 문장 매핑” 중 어디에 먼저 쓸지 우선순위를 정해, 한 페이지 분량의 실행 계획을 CONTENT_BACKLOG 또는 별도 문서에 추가.

5. **빈 상태·에러 메시지 정리**  
   - 공통으로 쓸 문구 풀을 두고, “데이터가 없습니다” → “아직 이 맥락에서 그려진 도면이 없습니다” 등 프로젝트 철학에 맞게 치환.  
   - 에러 페이지·API 오류 시 사용자 노출 문구도 동일 원칙으로 정리.

---

## 6. MNPS·서비스 운영 부문

### 6.1 현황 (MNPS_TEST_OVERVIEW·MNPS_REALIZATION_RISKS 등)

- 핵심 플로우(응답→채점→저장→결과), 이용약관·개인정보처리방침·면책, 분석 정확도·불성실 의심·백분위 등 **기능·법적 구색은 갖춰진 상태**.  
- 결제(Stripe 등) 연동 미구현. Bad 리포트 해제는 UI/플래그만 존재.  
- 규준(highCutoff 등)은 상수 고정. `normConfigFromDistribution`은 “권장값 제안”만 하고 자동 반영 없음.  
- 동적 OG 이미지(공유 썸네일) 미구현.  
- startedAt 검증 등 일부 검증은 “문서상 권장” 수준.

### 6.2 부족한 점

| 항목 | 내용 |
|------|------|
| 결제 연동 | 유료화 전환 시 Stripe(또는 선택한 PG) 웹훅·is_paid 갱신·환불 정책 등 설계·구현 필요. |
| 규준·가격 정당화 | 하드코딩된 규준을 “데이터 기반 규준”과 “규준 기반 해석” 문구로 보강해야 가격·신뢰도 정당화가 쉬워짐. |
| OG·공유 경험 | SNS 공유 시 아키타입·특성 등이 들어간 동적 OG 미구현으로 클릭률·브랜딩 기회 손실. |
| 로그인·세션 정책 | assessments에 user_id 전달 가능하나, 전역 인증·세션 정책이 문서화되어 있지 않음. |

### 6.3 보완 방안

1. **결제·유료화 로드맵**  
   - “베타 무료 → 일부 유료( Bad 해제 ) → 정식 유료” 등 단계를 정하고, 각 단계에서 필요한 API·DB·약관 변경을 목록화.  
   - Stripe(또는 대안) 연동 시 `is_paid` 갱신·웹훅 처리·실패 시 재시도 정책을 문서에 명시 후 구현.

2. **규준 루프 운영 절차**  
   - 1만 건 등 데이터가 쌓인 뒤 `normConfigFromDistribution`(또는 동일 목적 API) 결과를 어떻게 검토하고, NORM_CONFIG를 어떻게 반영할지(수동 반영 절차, 버전 관리)를 `docs/MNPS_NORMING_PROCEDURE.md`에 정리.  
   - 결과 화면에 “해석은 누적 데이터 기반 규준을 참고합니다” 등 문구 추가로 신뢰도·정당화 보강.

3. **동적 OG 이미지**  
   - @vercel/og 또는 동일 목적 라이브러리로, 결과 공유 시 assessmentId 또는 요약 정보를 쿼리로 받아 아키타입·상위 2특성 등이 들어간 이미지 생성.  
   - `generateMetadata` 또는 전용 API 라우트에서 OG URL 연결.

4. **인증·세션 정책 문서화**  
   - “비로그인(session_id) vs 로그인(user_id)” 사용 시나리오, Supabase Auth 연동 여부, 세션 만료·RLS와의 관계를 한 페이지로 정리.  
   - MNPS_TEST_OVERVIEW의 “로그인 연동” 권장과 연결.

---

## 7. 문서화·온보딩 부문

### 7.1 현황

- API 문서(스웨거 등), MNPS_TEST_OVERVIEW, ANALYSIS_ENGINE_OPTIMIZATION_REPORT, SYSTEM_CHECK_REPORT 등 **기술 문서는 많음**.  
- **사용자용** 회원가입/로그인·블로그·MNPS·성장 로드맵 가이드, FAQ는 미완 또는 부재.  
- **관리자용** 대시보드·모니터링·에러 대응·시스템 설정 가이드는 부분 완료.  
- 새 멤버가 “어디서부터 읽어야 하는가”를 안내하는 **온보딩 인덱스**가 없음.

### 7.2 부족한 점

| 항목 | 내용 |
|------|------|
| 사용자 가이드 | 회원가입·로그인·MNPS 테스트 방법·결과 읽는 법·성장 로드맵 흐름을 한글로 정리한 공개용 가이드 부재. |
| FAQ | “결과가 다른 이유”, “진단이 맞나요”, “데이터 삭제 방법” 등 자주 나올 질문에 대한 답변 문서 부재. |
| 문서 인덱스 | docs/ 내 문서가 많아 “처음 읽을 문서”, “기능별 문서”, “운영/배포 문서” 구분이 한눈에 안 들어옴. |

### 7.3 보완 방안

1. **사용자 가이드 1차 버전**  
   - “MNPS 받는 방법”, “결과는 어떻게 읽나요”, “이 결과는 진단이 아닙니다”를 한 페이지에 요약.  
   - 서비스 소개 페이지 또는 푸터에서 링크. 필요 시 “성장 로드맵 이용 방법”을 별도 섹션으로 추가.

2. **FAQ 페이지 또는 문서**  
   - `docs/FAQ.md` 또는 `/faq` 페이지에 5~10개 질문–답변 수준으로 정리.  
   - 면책·개인정보·데이터 삭제·결과 해석 한계 등을 포함.

3. **문서 인덱스**  
   - `docs/README.md`(또는 `docs/INDEX.md`)에 다음을 정리:  
     - **처음 읽을 것**: PROJECT_PHILOSOPHY, (선택) PROJECT_GAPS_AND_REMEDIATION.  
     - **기능별**: MNPS → MNPS_TEST_OVERVIEW, 성장 로드맵 → ANALYSIS_ENGINE_OPTIMIZATION_REPORT, 블로그 → BLOG_* 등.  
     - **운영·배포**: DEPLOYMENT_*, SYSTEM_CHECK_REPORT, LOCAL_DEV_GUIDE 등.  
   - 링크만 나열해도 되고, 1~2문장 설명을 붙이면 온보딩에 유리함.

---

## 8. 접근성·포용 부문

### 8.1 현황 (ACCESSIBILITY.md)

- 스킵 링크, 키보드 단축키, ARIA, 폼 레이블·에러, 포커스 관리, 스크린 리더 지원 등 **기본 접근성은 구현됨**.  
- WCAG 2.1 Level AA를 목표로 명시.  
- “고대비 모드”, “폰트 크기 조절” 등은 “향후 추가 예정”으로만 기록.

### 8.2 부족한 점

| 항목 | 내용 |
|------|------|
| 고대비·폰트 조절 | 아직 미구현. 일부 사용자에게 필요. |
| 접근성 회귀 검증 | UI 변경 시 접근성 회귀를 자동·수동으로 검증하는 절차가 문서화되어 있지 않음. |
| MNPS·성장 로드맵 특화 | 긴 폼·다단계 플로우에서 키보드·포커스·에러 노출이 일관되는지 점검 필요. |

### 8.3 보완 방안

1. **접근성 체크리스트**  
   - 새 페이지·주요 변경 시: 키보드만으로 완료 가능한가, 에러가 role="alert" 등으로 노출되는가, 제목 계층이 맞는가 등을 체크리스트로 두고, e2e/accessibility.spec.ts와 연동.

2. **고대비·폰트 조절**  
   - CSS 변수로 테마(고대비)·폰트 크기(보통/크게)를 두고, 설정 페이지 또는 푸터에서 토글.  
   - 우선순위가 높지 않다면 “Phase 2 접근성”으로 문서에만 명시하고, 추후 구현.

3. **MNPS/성장 로드맵 접근성 점검**  
   - 테스트 진행·결과 페이지에서 포커스 순서, 단계 전환 시 안내, 오류 메시지 접근성을 한 번 수동 점검하고, 부족한 부분만 보완.

---

## 9. 보완 우선순위 제안

아래는 “영향도·필요성”을 고려한 우선순위 제안이다. 팀 상황에 따라 조정 가능하다.

| 우선순위 | 부문 | 보완 항목 | 목적 |
|----------|------|-----------|------|
| P0 | 철학 | 철학–UI 매핑 문서, 결과 페이지 “맥락” 문구 | 서비스 정체성과 일관성 확보 |
| P0 | 운영 | MNPS/마인드 아키텍터 플래그 전략·문서화 | 실제 서비스 노출 결정 근거 마련 |
| P1 | 기술 | 린트 error 0, CI 최소 사양(린트·테스트·빌드) | 품질 게이트 유지 |
| P1 | 문서 | docs 인덱스, 사용자 가이드 1차, FAQ | 온보딩·사용자 신뢰 |
| P2 | MNPS | 규준 루프 절차, 동적 OG, (유료화 시) 결제 연동 | 운영·수익·공유 경험 |
| P2 | 콘텐츠 | 블로그/결과 톤 체크리스트, 감정 프레임워크 활용 계획 | PROJECT_PHILOSOPHY 정합성 |
| P3 | 테스트 | MNPS·성장 로드맵 E2E 1사이클, API 통합 테스트 1~2개 | 회귀 방지 |
| P3 | 접근성 | 고대비·폰트 조절 또는 Phase 2 명시, 접근성 체크리스트 | 포용성 강화 |

---

## 10. 결론

- **부족한 부분**은 크게 **철학–UI 정합성**, **테스트·CI 자동화**, **사용자·관리자 문서·FAQ**, **MNPS 운영(규준·결제·OG)**, **콘텐츠 톤·맥락 일관성**, **접근성 고급 기능**으로 묶을 수 있다.  
- 각 부문에 대해 **“무엇을 할 것인가”**와 **“어떤 문서·코드로 보완할 것인가”**를 위와 같이 정리했다.  
- **PROJECT_PHILOSOPHY**와 **.cursorrules**를 기준으로, 새 기능·콘텐츠는 “맥락적 존재”와 “맥락 우선주의”에 맞게 설계하고, 기존 부족분은 위 우선순위에 따라 단계적으로 보완하는 것을 권장한다.

---

*이 문서는 연구 시점의 스냅샷이며, 이후 변경 사항이 반영되지 않을 수 있습니다. 보완 진행 시 본 문서를 갱신하는 것이 좋습니다.*
