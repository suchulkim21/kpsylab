# Dark Nature Test κµ¬μ΅° λΉ„κµ λ¶„μ„

## π“ ν„μ¬ κµ¬μ΅° vs μ μ• κµ¬μ΅°

---

## 1. λ¬Έν•­ κ΄€λ¦¬ λ°©μ‹

### ν„μ¬ κµ¬μ΅° (ν•λ“μ½”λ”©)
```typescript
// app/mnps/test/questions.ts
export const DARK_NATURE_QUESTIONS: DarkNatureQuestion[] = [
  { id: 'n1', category: 'darkTetrad', trait: 'narcissism', ... },
  // ... 36λ¬Έν•­ ν•λ“μ½”λ”©
];
```

**μ¥μ :**
- β… λΉ λ¥Έ κ°λ°/λ°°ν¬
- β… λ²„μ „ κ΄€λ¦¬ μ©μ΄ (GitμΌλ΅ μ¶”μ )
- β… μ™Έλ¶€ DB μμ΅΄μ„± μ—†μ
- β… λ°°ν¬ μ‹ λ¬Έν•­ λ³€κ²½ μ¦‰μ‹ λ°μ

**λ‹¨μ :**
- β λ¬Έν•­ μμ • μ‹ μ½”λ“ μ¬λ°°ν¬ ν•„μ”
- β A/B ν…μ¤νΈλ‚ λ¬Έν•­ κ°€μ¤‘μΉ μ‹¤ν— μ–΄λ ¤μ›€
- β λ¬Έν•­λ³„ ν†µκ³„ λ¶„μ„ μ ν•μ 

---

### μ μ• κµ¬μ΅° (DB κΈ°λ°)
```sql
-- Supabase questions ν…μ΄λΈ”
CREATE TABLE questions (
  id INT PRIMARY KEY,
  category ENUM('MACH', 'SADISM', 'NARC', 'PSYCHO', ...),
  content TEXT,
  weight FLOAT DEFAULT 1.0,
  reverse_scored BOOLEAN DEFAULT FALSE
);
```

**μ¥μ :**
- β… λ¬Έν•­ μμ • μ‹ μ½”λ“ λ°°ν¬ λ¶ν•„μ” (DBλ§ μ—…λ°μ΄νΈ)
- β… λ¬Έν•­λ³„ κ°€μ¤‘μΉ μ‹¤μ‹κ°„ μ΅°μ • κ°€λ¥
- β… A/B ν…μ¤νΈ, λ¬Έν•­ μμ„ μ‹¤ν— μ©μ΄
- β… λ¬Έν•­λ³„ μ‘λ‹µ ν†µκ³„ λ¶„μ„ κ°€λ¥

**λ‹¨μ :**
- β μ΄κΈ° DB μ¤ν‚¤λ§ μ„¤κ³„ ν•„μ”
- β Supabase μ—°κ²° μμ΅΄μ„±
- β λ¬Έν•­ λ³€κ²½ μ‹ DB λ§μ΄κ·Έλ μ΄μ… ν•„μ”

---

## 2. μ‘λ‹µ μ €μ¥ λ°©μ‹

### ν„μ¬ κµ¬μ΅° (SessionStorage)
```typescript
// app/mnps/test/page.tsx
sessionStorage.setItem('darkNatureResult', JSON.stringify(resultData));
```

**μ¥μ :**
- β… μ¦‰μ‹ κµ¬ν„ κ°€λ¥
- β… μ„λ²„ λ¶€ν• μ—†μ
- β… μµλ…μ„± λ³΄μ¥ (κ°μΈμ •λ³΄ μμ§‘ μ—†μ)

**λ‹¨μ :**
- β λΈλΌμ°μ € λ‹«μΌλ©΄ λ°μ΄ν„° μ†μ‹¤
- β μ—¬λ¬ κΈ°κΈ° κ°„ μ—°μ† λ¶κ°€
- β κ²°κ³Ό μ¬μ΅°ν λ¶κ°€
- β ν†µκ³„ λ¶„μ„ λ¶κ°€

---

### μ μ• κµ¬μ΅° (DB μ €μ¥)
```sql
-- assessments ν…μ΄λΈ”
CREATE TABLE assessments (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id),
  status ENUM('IN_PROGRESS', 'COMPLETED'),
  is_paid BOOLEAN DEFAULT FALSE,
  total_d_score FLOAT,
  created_at TIMESTAMP
);

-- responses ν…μ΄λΈ”
CREATE TABLE responses (
  id BIGINT PRIMARY KEY,
  assessment_id UUID REFERENCES assessments(id),
  question_id INT REFERENCES questions(id),
  score INT -- 1~5
);
```

**μ¥μ :**
- β… μκµ¬ μ €μ¥ (μ¬μ΅°ν κ°€λ¥)
- β… μ—¬λ¬ κΈ°κΈ° κ°„ μ—°μ† κ°€λ¥
- β… μ‚¬μ©μλ³„ ν…μ¤νΈ μ΄λ ¥ κ΄€λ¦¬
- β… μ „μ²΄ ν†µκ³„ λ¶„μ„ κ°€λ¥
- β… μ λ£ κ²°μ  μ—°λ™ μ©μ΄

**λ‹¨μ :**
- β κ°μΈμ •λ³΄ μ²λ¦¬ ν•„μ” (GDPR λ“± κ³ λ ¤)
- β DB μ¤ν† λ¦¬μ§€ λΉ„μ©
- β μ΄κΈ° κµ¬ν„ λ³µμ΅λ„ μ¦κ°€

---

## 3. λ¦¬ν¬νΈ μƒμ„± λ°©μ‹

### ν„μ¬ κµ¬μ΅° (ν•¨μ κΈ°λ°)
```typescript
// lib/mnps/darkNatureScoring.ts
export function buildInterpretation(result: DarkNatureResult): DarkNatureInterpretation {
  // μ μ κΈ°λ°μΌλ΅ Good/Bad λ¦¬ν¬νΈ μƒμ„±
  if (high(traitScores.machiavellianism)) {
    goodHighlights.push('μ „λµμ  νλ‹¨λ ¥μ΄ λ›°μ–΄λ‚©λ‹λ‹¤.');
    badHighlights.push('νƒ€μΈμ„ λ„κµ¬λ΅ λ³΄λ” κ²½ν–¥μ΄ κ°•ν•©λ‹λ‹¤.');
  }
  // ...
}
```

**μ¥μ :**
- β… λ΅μ§μ΄ μ½”λ“μ— λ…ν™•ν λ“λ¬λ‚¨
- β… λ²„μ „ κ΄€λ¦¬ κ°€λ¥
- β… νƒ€μ… μ•μ •μ„±

**λ‹¨μ :**
- β λ¦¬ν¬νΈ λ¬Έκµ¬ λ³€κ²½ μ‹ μ½”λ“ μ¬λ°°ν¬ ν•„μ”
- β μ μ κµ¬κ°„λ³„ μ„Έλ°€ν• μ»¤μ¤ν„°λ§μ΄μ§• μ–΄λ ¤μ›€

---

### μ μ• κµ¬μ΅° (DB + λ§¤ν•‘ ν…μ΄λΈ”)
```sql
-- results_metadata ν…μ΄λΈ”
CREATE TABLE results_metadata (
  assessment_id UUID PRIMARY KEY,
  good_report_json JSONB,  -- λ¬΄λ£ λ¦¬ν¬νΈ
  bad_report_json JSONB,    -- μ λ£ λ¦¬ν¬νΈ (μ•”νΈν™” κ¶μ¥)
  radar_chart_data JSONB
);
```

**λ§¤ν•‘ λ΅μ§ μμ‹:**
| μ„±ν–¥ | μ μ | Good λ²„μ „ | Bad λ²„μ „ |
|------|------|-----------|----------|
| λ§ν‚¤μ•„λ²¨λ¦¬μ¦ | λ†’μ | "νƒμ›”ν• μ „λµμ  μ‹¤ν–‰λ ¥" | "λƒ‰νΉν• μ²΄μ¤ ν”λ μ΄μ–΄" |
| μ‚¬λ””μ¦ | λ†’μ | "μ§€λ°°μ μΈ μν–¥λ ¥" | "μ”μΈν• ν¬μ‹μ" |

**μ¥μ :**
- β… λ¦¬ν¬νΈ λ¬Έκµ¬ μ‹¤μ‹κ°„ μμ • κ°€λ¥
- β… μ μ κµ¬κ°„λ³„ μ„Έλ°€ν• μ»¤μ¤ν„°λ§μ΄μ§•
- β… A/B ν…μ¤νΈ (λ‹¤μ–‘ν• λ¦¬ν¬νΈ λ²„μ „)
- β… LLM μƒμ„± λ¦¬ν¬νΈ μ €μ¥ κ°€λ¥

**λ‹¨μ :**
- β JSON κµ¬μ΅° κ΄€λ¦¬ λ³µμ΅λ„
- β λ¦¬ν¬νΈ ν…ν”λ¦Ώ λ²„μ „ κ΄€λ¦¬ ν•„μ”

---

## 4. λ¬Έν•­ κµ¬μ„± λ°©μ‹ λΉ„κµ

### ν„μ¬ λ¬Έν•­ μμ‹
```typescript
{
  id: 'm1',
  text: 'λ©μ μ„ λ‹¬μ„±ν•κΈ° μ„ν•΄μ„λΌλ©΄, λ„λ•μ μΌλ΅ μμ‹¬μ¤λ¬μ΄ μλ‹¨λ„ μ •λ‹Ήν™”λ  μ μλ‹¤κ³  μƒκ°ν•λ‹¤.',
  trait: 'machiavellianism',
  subFactor: 'moralDisengagement',
}
```

**νΉμ§•:**
- μ§μ ‘μ μ΄κ³  λ…ν™•ν• λ¬Έν•­
- "λ„λ•μ μΌλ΅ μμ‹¬μ¤λ¬μ΄ μλ‹¨" κ°™μ€ κ°•ν• ν‘ν„

---

### μ μ• λ¬Έν•­ μμ‹ (λ§ν‚¤μ•„λ²¨λ¦¬μ¦)
```
μ¤‘μ”ν• λ©ν‘λ¥Ό λ‹¬μ„±ν•κΈ° μ„ν•΄μ„λΌλ©΄ μ‚¬μ†ν• λ„λ•μ  κ·μΉ™μ€ μ μ—°ν•κ² μ μ©ν•  μ μλ‹¤.

μ‚¬λλ“¤μ„ λ‚΄ μλ„λ€λ΅ μ›€μ§μ΄κΈ° μ„ν•΄ μƒν™©μ— λ§λ” κ°€λ©΄(κ±°μ§“λ§)μ„ μ“°λ” κ²ƒμ€ μ‚¬νμ  μ§€λ¥μ΄λ‹¤.
```

**νΉμ§•:**
- β… "μ‚¬μ†ν• λ„λ•μ  κ·μΉ™" β†’ λ κ³µκ²©μ  ν‘ν„
- β… "μ‚¬νμ  μ§€λ¥" β†’ κΈμ •μ  ν”„λ μ΄λ°
- β… λ°©μ–΄ κΈ°μ λ¥Ό μ„Έμ°μ§€ μ•λ„λ΅ μΌμƒμ  μƒν™© λ¬μ‚¬

**μ°¨μ΄μ :**
- ν„μ¬: μ§μ ‘μ , κ°•ν• ν‘ν„
- μ μ•: κ°„μ ‘μ , μ™„ν™”λ ν‘ν„ (λ°©μ–΄ κΈ°μ  νν”Ό)

---

## 5. κ²°μ  λ¨λΈ μ§€μ›

### ν„μ¬ κµ¬μ΅°
- β κ²°μ  μ—°λ™ μ—†μ
- β `hasPaid` μƒνƒλ§ ν΄λΌμ΄μ–ΈνΈμ—μ„ κ΄€λ¦¬
- β Bad Versionμ€ λ‹¨μν blur μ²λ¦¬

### μ μ• κµ¬μ΅°
- β… `assessments.is_paid` μ»¬λΌμΌλ΅ κ²°μ  μƒνƒ κ΄€λ¦¬
- β… `results_metadata.bad_report_json`μ€ κ²°μ  ν›„μ—λ§ μ΅°ν κ°€λ¥
- β… κ²°μ  API μ—°λ™ (Stripe/Toss λ“±)

---

## π“‹ κ¶μ¥ λ§μ΄κ·Έλ μ΄μ… μ „λµ

### Phase 1: ν•μ΄λΈλ¦¬λ“ (ν„μ¬ + DB)
1. **λ¬Έν•­μ€ ν•λ“μ½”λ”© μ μ§€** (λΉ λ¥Έ λ°°ν¬)
2. **μ‘λ‹µλ§ DB μ €μ¥** (`assessments`, `responses` ν…μ΄λΈ”)
3. **λ¦¬ν¬νΈλ” ν•¨μ κΈ°λ° μ μ§€** (λΉ λ¥Έ λ°λ³µ)

### Phase 2: DB κΈ°λ° μ „ν™
1. **λ¬Έν•­μ„ DBλ΅ μ΄μ „** (`questions` ν…μ΄λΈ”)
2. **λ¦¬ν¬νΈ ν…ν”λ¦Ώ DBν™”** (`results_metadata` λλ” λ³„λ„ ν…ν”λ¦Ώ ν…μ΄λΈ”)
3. **κ²°μ  μ—°λ™ μ¶”κ°€**

### Phase 3: κ³ λ„ν™”
1. **LLM κΈ°λ° λ¦¬ν¬νΈ μƒμ„±** (DBμ— μ €μ¥)
2. **A/B ν…μ¤νΈ** (λ¬Έν•­ μμ„, λ¦¬ν¬νΈ λ²„μ „)
3. **ν†µκ³„ λ€μ‹λ³΄λ“**

---

## π― μ¦‰μ‹ μ μ© κ°€λ¥ν• κ°μ„ μ‚¬ν•­

### 1. λ¬Έν•­ ν…μ¤νΈ κ°μ„  (μ μ• λ°©μ‹ λ°μ)
- ν„μ¬ λ¬Έν•­μ„ λ” κ°„μ ‘μ μ΄κ³  μ™„ν™”λ ν‘ν„μΌλ΅ μμ •
- "μ‚¬μ†ν• λ„λ•μ  κ·μΉ™", "μ‚¬νμ  μ§€λ¥" κ°™μ€ ν”„λ μ΄λ° μ‚¬μ©

### 2. μ‘λ‹µ DB μ €μ¥ μ¶”κ°€
- Supabaseμ— `assessments`, `responses` ν…μ΄λΈ” μƒμ„±
- ν…μ¤νΈ μ™„λ£ μ‹ DB μ €μ¥ (μ„ νƒμ , μµλ… κ°€λ¥)

### 3. λ¦¬ν¬νΈ λ§¤ν•‘ λ΅μ§ κ°•ν™”
- μ μ κµ¬κ°„λ³„ λ” μ„Έλ°€ν• Good/Bad λ¬Έκµ¬ μ°¨λ³„ν™”
- μ μ•λ λ§¤ν•‘ ν…μ΄λΈ” λ΅μ§ λ°μ

---

## π’΅ κ²°λ΅ 

**ν„μ¬ κµ¬μ΅°**λ” λΉ λ¥Έ ν”„λ΅ν† νƒ€μ΄ν•‘κ³Ό λ°°ν¬μ— μ ν•©ν•©λ‹λ‹¤.  
**μ μ• κµ¬μ΅°**λ” μ¥κΈ°μ  ν™•μ¥μ„±κ³Ό λΉ„μ¦λ‹μ¤ λ¨λΈ(μ λ£ κ²°μ )μ— μ ν•©ν•©λ‹λ‹¤.

**κ¶μ¥:** Phase 1 ν•μ΄λΈλ¦¬λ“ λ°©μ‹μΌλ΅ μ‹μ‘ β†’ μ μ§„μ  DB μ „ν™
